@startuml
!theme blueprint
skinparam backgroundColor #F8F9FA
skinparam activity {
    BackgroundColor #E3F2FD
    BorderColor #1976D2
    FontColor #1565C0
    FontSize 11
    FontName Arial
}
skinparam activityDiamond {
    BackgroundColor #FFF3E0
    BorderColor #F57C00
    FontColor #E65100
}
skinparam partition {
    BackgroundColor #FAFAFA
    BorderColor #757575
    FontColor #424242
    FontSize 12
    FontStyle bold
}
skinparam note {
    BackgroundColor #E8F5E8
    BorderColor #4CAF50
    FontColor #2E7D32
    FontSize 10
}

title <size:16><b>SƠ ĐỒ HOẠT ĐỘNG ONBOARDING KHÁCH HÀNG</b></size>

|#LightBlue|**KHÁCH HÀNG**|
start
:Mở ứng dụng\nMobile Banking;
note right
Khách hàng khởi tạo
quá trình mở tài khoản
end note

:Điền thông tin cá nhân\n(Họ tên, ngày sinh, SĐT, email);

:Upload giấy tờ định danh\n(CCCD/Hộ chiếu + Selfie);

:Gửi hồ sơ\nmở tài khoản;

|#LightGreen|**MOBILE APP**|
:Thu thập dữ liệu\ntừ form đăng ký;

:Tiền xử lý ảnh\n(Crop, resize, format);

:Gọi API Backbase\n(Customer Onboarding Request);

|#LightYellow|**BACKBASE PLATFORM**|
:Nhận dữ liệu\ntừ Mobile App;

:Kiểm tra tính hợp lệ\n(Form validation, Business rules);

:Tích hợp tới Customer Master\n(Gọi Create Customer API);

|#LightPink|**CUSTOMER MASTER**|
:Nhận request\nmở CIF mới;

:Thực hiện kiểm tra KYC\n(Đối chiếu giấy tờ, eKYC,\nWatchlist/AML screening);

if (KYC thành công?) then (Có)
    :Sinh mã CIF\n(Customer ID);

    :Lưu trữ hồ sơ khách hàng\nvào CSDL;

    :Trả kết quả về Backbase\n(CIF + Trạng thái thành công);

    |#LightYellow|**BACKBASE PLATFORM**|
    :Sinh yêu cầu mở\ntài khoản CASA liên kết CIF;

else (Không)
    :Trả lỗi về Backbase\n(Thông báo lý do thất bại);

    |#LightYellow|**BACKBASE PLATFORM**|
    :Xử lý lỗi KYC;
endif

:Trả kết quả cuối cùng\ncho Mobile App;

|#LightGreen|**MOBILE APP**|
if (Kết quả thành công?) then (Có)
    :Hiển thị thông báo\n"Mở tài khoản thành công"\n+ Thông tin tài khoản;
else (Không)
    :Hiển thị thông báo lỗi\nvà hướng dẫn khắc phục;
endif

|#LightBlue|**KHÁCH HÀNG**|
:Nhận kết quả\nvà sử dụng dịch vụ;

stop

@enduml